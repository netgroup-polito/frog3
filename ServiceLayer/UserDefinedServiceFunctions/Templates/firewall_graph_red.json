{
	"profile": {
		"id": "2",
		"name": "Firewall - expansion",
		"VNFs": [
			{
				"vnf_descriptor": "switch.json",
				"id": "Control_Switch_Firewall",
				"ports": [
					{
						"id": "L2Port:0",
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "IPTraf",
											"port": "control:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "29443"
											}
										]
									}
								}
							]
						}
					},
					{
						"id": "L2Port:1",
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "IPTraf_no80",
											"port": "control:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "100",
												"id": "134248"
											}
										]
									}
								}
							]
						}
					},
					{
						"id": "L2Port:2",
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"endpoint": {
											"port": "control:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "589"
											}
										]
									}
								}
							]
						},
						"ingoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "Control_Switch_Firewall",
											"port": "L2Port:2"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "100",
												"id": "182"
											}
										],
										"ingress_endpoint": "control:0"
									}
								}
							]
						}
					}
				],
				"name": "Switch"
			},
			{
				"vnf_descriptor": "client_iptraf.json",
				"id": "IPTraf",
				"ports": [
					{
						"id": "inout:1",
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "Firewall_80",
											"port": "User:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "166623948"
											}
										]
									}
								}
							]
						}
					},
					{
						"id": "inout:0",
						"ingoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "IPTraf",
											"port": "inout:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"etherType": "0x800",
												"protocol": "tcp",
												"destPort": "80",
												"priority": "2898",
												"id": "197657764"
											}
										],
										"ingress_endpoint": "User:0"
									}
								}
							]
						},
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"endpoint": {
											"port": "User:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "12231113"
											}
										]
									}
								}
							]
						}
					},
					{
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "Control_Switch_Firewall",
											"port": "L2Port:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "589"
											}
										]
									}
								}
							]
						},
						"id": "control:0"
					}
				],
				"name": "ntop80_red"
			},
			{
				"name": "dpi_red",
				"ports": [
					{
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "IPTraf",
											"port": "inout:1"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "121773"
											}
										]
									}
								}
							]
						},
						"id": "User:0"
					},
					{
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"endpoint": {
											"port": "Internet:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "5"
											}
										]
									}
								}
							]
						},
						"ingoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "Firewall_80",
											"port": "Internet:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"etherType": "0x800",
												"protocol": "tcp",
												"destPort": "80",
												"priority": "2898",
												"id": "1455"
											}
										],
										"ingress_endpoint": "Internet:0"
									}
								}
							]
						},
						"id": "Internet:0"
					}
				],
				"id": "Firewall_80",
				"vnf_descriptor": "firewall.json"
			},
			{
				"name": "ntop_red",
				"ports": [
					{
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"endpoint": {
											"port": "User:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "1213"
											}
										]
									}
								}
							]
						},
						"ingoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "IPTraf_no80",
											"port": "inout:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "100",
												"id": "197444"
											}
										],
										"ingress_endpoint": "User:0"
									}
								}
							]
						},
						"id": "inout:0"
					},
					{
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"endpoint": {
											"port": "Internet:0"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "5"
											}
										]
									}
								}
							]
						},
						"ingoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "IPTraf_no80",
											"port": "inout:1"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "100",
												"id": "113"
											}
										],
										"ingress_endpoint": "Internet:0"
									}
								}
							]
						},
						"id": "inout:1"
					},
					{
						"outgoing_label": {
							"flowrules": [
								{
									"action": {
										"VNF": {
											"id": "Control_Switch_Firewall",
											"port": "L2Port:1"
										},
										"type": "output"
									},
									"flowspec": {
										"matches": [
											{
												"priority": "2",
												"id": "543433"
											}
										]
									}
								}
							]
						},
						"id": "control:0"
					}
				],
				"id": "IPTraf_no80",
				"vnf_descriptor": "client_iptraf.json"
			}
		],
		"endpoints": [
			{
				"id": "User:0",
				"name": "User_Layer"
			},
			{
				"id": "Internet:0",
				"name": "Internet_Layer"
			},
			{
				"id": "control:0",
				"name": "Control_Layer"
			}
		]
	}
}
